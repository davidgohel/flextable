---
title: "Pdflatex not working with flextable"
engine: knitr
format:
  pdf: 
    pdf-engine: pdflatex
    keep-tex: true
---


```{r}
#| label: setup

library(flextable)


# different ways to access quarto metadata ----
## Many things listed in quarto_metadata, like default options, but not the current options used in the yaml
quarto_metadata <- knitr::opts_current$get()
saveRDS(quarto_metadata, "./quarto_metadata.rds")

## Returns an empty string, maybe not using it properly
quarto_metadata_second_way <- Sys.getenv("QUARTO_EXECUTE_INFO")
saveRDS(quarto_metadata_second_way, "./quarto_metadata_second_way.rds")

## This command returns exactly the yaml of the header, great!! :-)
rmarkdown_metadata <- rmarkdown::metadata
saveRDS(rmarkdown_metadata, "./rmarkdown_metadata.rds")

## Returns only the output file
rmarkdown_pandoc_args <- knitr::opts_knit$get("rmarkdown.pandoc.args")
saveRDS(rmarkdown_pandoc_args, "./rmarkdown_pandoc_args.rds")

# rmarkdown::render("./tests/testthat/qmd/use-printer-with-pdflatex.qmd",
#                   output_format = c("pdf_document"),
#                   output_file = "C:/Users/basti/OneDrive/04. BNCL (Post Doc)/Open-Source Development/flextable/tests/testthat/qmd/use-printer-with-pdflatex.qmd")


# quarto::quarto_render("./tests/testthat/qmd/use-printer-with-pdflatex.qmd")
```


- `flextable` with Equations, see @tbl-flextable:

```{r}
#| label: tbl-flextable


eqs_flextable <- c(
    "(ax^2 + bx + c = 0)",
    "a \\ne 0",
    "x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}")
df <- tibble::tibble(`Y \\sim W` = eqs_flextable)


ft <- flextable(df) |>
  compose(j = 1, part = "header",
          value = as_paragraph(as_equation(`Y \\sim W`, width = 2, height = .5)),
          use_dot = TRUE) |>
  compose(j = 1, part = "body",
          value = as_paragraph(as_equation(`Y \\sim W`, width = 2, height = .5))) |>
  align(align = "center", part = "all")

ft

```
